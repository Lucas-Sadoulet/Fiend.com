<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chatbot</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    header {
      position: sticky;
      top: 0;
      background: #ffffff;
      color: rgb(0, 0, 0);
      text-align: center;
      padding: 15px;
      font-size: 20px;
      z-index: 1;
    }

    #chatbox {
      flex: 1;
      overflow-y: auto;
      padding: 15px;
      background: #e5ddd5;
    }

    .message {
      max-width: 70%;
      padding: 10px 15px;
      border-radius: 15px;
      margin: 10px 0;
      display: inline-block;
      clear: both;
      white-space: pre-wrap;
    }

    .user {
      background: #DCF8C6;
      float: right;
      text-align: right;
    }

    .bot {
      background: #fff;
      float: left;
      text-align: left;
    }

    footer {
      position: sticky;
      bottom: 0;
      background: #ffffff;
      padding: 10px;
      border-top: 1px solid #ccc;
      display: flex;
      gap: 10px;
    }

    input[type="text"] {
      flex: 1;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background: #45a049;
    }
  </style>
</head>
<body>

  <header>
    Simple Chatbot
  </header>

  <div id="chatbox"></div>

  <footer>
    <input type="text" id="userInput" placeholder="Type a message..." />
    <button onclick="sendMessage()">Send</button>
  </footer>

  <script>
    const responses_tree = {3:[10,20,30,40,3], 14:[3], 24:[3], 31:[3, 32], 34:[3]};
    let state = 0;
    const responses = [
        "Hello, I'm Fiend, a tool to help inform about the dangers of unethical AI integration in our daily lives. Today, lets look at how a product, like Friend.com's pendants, pose ethical concerns to our legal security, privacy, and mental health. To learn more, press <enter>",
        "Alright, lets begin by discussing what Friend.com is: \nFriend.com is an AI-powered platform that offers a wearable pendant designed to act as a personal assistant and emotional companion. The pendant is marketed as a constant presence that listens to your conversations, provides summaries, gives feedback, and helps you “understand yourself better.” It operates passively and continuously—no need for manual activation.",
        'How does it work? \n - Continuously records nearby conversations \n - Analyzes tone, emotion, and keywords \n - Provides feedback and conversation summaries \n - Learns over time through user interaction \n - Displays insights and suggestions via a mobile app\n - "your friend is always listening… [with] free will for when they decide to reach out to you”',
        "Now that you better understand the Friend pendant, lets discuss something more specific. Which topic would you like to talk about next?\n ( type topic name or number to continue )\n 1. Privacy and Surveillance \n 2. Legal Concerns  \n 3. Mental Health \n 4. Conclusions",
        "Text State 4",
        "Text State 5",
        "Text State 6",
        "Text State 7",
        "Text State 8",
        "Text State 9",
        "Alright, lets talk about the data privacy and surveillance concerns. This sections will look at some of the overarching law subverted by this technology",
        "Invasion of Personal Privacy: \n Constant recording of both users and bystanders without consent. \n Turning everyday conversations into permanent data",
        "Broken Informed Consent: \n Bystanders cannot opt out or even know they are being recorded \n Users may not fully understand data usage and risks",
        "Unreliable AI Feedback: \n Summaries miss nuance, sarcasm, and emotion\n False sense of accuracy and emotional authority",
        "Illusion of “Friendship:\n AI simulates care without true empathy, accountability, or trust\n Risk of emotional dependency and manipulation \n Learn more in the 'Mental Health' section",
        "Text State 15",
        "Text State 16",
        "Text State 17",
        "Text State 18",
        "Text State 19",
        "Alright, lets talk about the legal concerns",
        "Text State 21",
        "Text State 22",
        "Text State 23",
        "Text State 24",
        "Text State 25",
        "Text State 26",
        "Text State 27",
        "Text State 28",
        "Text State 29",
        "Alright, lets talk about the mental health concerns",
        "",
        "Text State 32",
        "Text State 33",
        "Content warning: the following section will discuss sensitive topics such as depression, suicide, and murder. \n 1. Return to Hub \n 2. Continue",
        "Text State 35",
        "Text State 36",
        "Text State 37",
        "Text State 38",
        "Text State 39",
        "Conclusion",
    ]


    typeResponse(responses[0]);
    const inputField = document.getElementById("userInput");

    inputField.addEventListener("keydown", function (event) {
      if (event.key === "Enter") {
        event.preventDefault();
        sendMessage();
      }
    });

    function sendMessage() {
      const input = inputField.value.trim().toLowerCase();
      if (input != "")
        {

      addMessage("user", input);
      inputField.value = "";
        }
        let select = -1;
        if (state == 3) {
            if (input === "1" || input.includes("privacy") || input.includes("surveillance")) {
            select = 0;
            } else if (input === "2" || input.includes("legal") || input.includes("law")) {
            select = 1;
            } else if (input === "3" || input.includes("mental") || input.includes("health")) {
            select = 2;
            } else if (input === "4" || input.includes("conclusion") || input.includes("summary")) {
            select = 3;
            } 
            else{
                select = 4
            }
        }
      if(state in responses_tree){
        if(select == -1){
            state = responses_tree[state][0];   
        } else {
            state = responses_tree[state][select]; 
        } 
        }else {
        state += 1;
      }
      console.log(state)
      const response = responses[state];

      setTimeout(() => {
        typeResponse(response);
      }, 400);
    }

    function addMessage(sender, text) {
      const chatbox = document.getElementById("chatbox");
      const messageDiv = document.createElement("div");
      messageDiv.className = `message ${sender}`;
      messageDiv.innerText = text;
      chatbox.appendChild(messageDiv);
      chatbox.scrollTop = chatbox.scrollHeight;
    }

    function typeResponse(text) {
      const chatbox = document.getElementById("chatbox");
      const messageDiv = document.createElement("div");
      messageDiv.className = "message bot";
      chatbox.appendChild(messageDiv);

      let i = 0;
      const typingInterval = setInterval(() => {
        messageDiv.innerText += text.charAt(i);
        i++;
        chatbox.scrollTop = chatbox.scrollHeight;

        if (i >= text.length) {
          clearInterval(typingInterval);
        }
      }, 15); // Adjust typing speed here
    }
  </script>

</body>
</html>
